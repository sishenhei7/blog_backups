## 概述

最近对http很感兴趣，于是开始看[《http权威指南》](https://book.douban.com/subject/10746113/)。别人都说这本书有点老了，而且内容太多。我个人觉得这本书**写的太好了**，非常长知识，让你知道关于http的很多概念，不仅告诉你怎么做，还告诉你为什么这么做。于是我把学到的知识点记录下来，供以后开发时参考，相信对其他人也有用。

### 集成点：网关、隧道及中继

1.**web网关**在一侧使用http协议，在另一侧使用另一种协议。服务端网关通过http与客户端对话，通过其他协议与服务端通信。；客户端网关通过其他协议与客户端对话，通过http与服务端通信。

2.协议网关：
- **服务器端web网关**：请求流入原始服务器时，服务端web网关会将客户端http请求转换为其他协议。
- **服务端安全网关**：http/https，客户端用普通的http浏览web内容，但网关会自动加密用户的会话。
- **客户端安全加速网关**：https/http，他们 位于web服务器之前，通常作为不可见的拦截网关或反向代理使用，它们接受https流量，对安全流量进行解密，并向web服务器发送普通的http请求。

3.**资源网关**（网关是一个应用程序）：
- CGI：通用网关接口。
- 服务器扩展API。

4.**web隧道**允许用户通过http连接发送非http流量，这样就可以在http上捎带其他协议数据了。使用web隧道最常见的原因是要在http连接中嵌入非http流量，这样，这类流量就可以穿过只允许web流量通过的防火墙了。

5.**web隧道**是用http的**connect方法**建立起来的，connect方法并不是http/1.1核心规范的一部分，但却是一种得到广泛应用的扩展。connect方法请求隧道网关创建一条到达任意目的服务器和端口的TCP连接，并对客户端和服务器之间的后继数据进行**盲转发**。

6.**connect请求**：
```
CONNECT home.netscape.com:443 HTTP/1.0
User-agent: Mozilla/4.0
```

7.**connect响应**(不需要包含Content-Type首部)：
```
HTTP/1.0 200 Connection Established
Proxy-agent: Netscape-Proxy/1.1
```

8.通常会用隧道将**非http流量**传过端口过滤防火墙。这一点可以得到很好的利用，比如通过防火墙传输安全ssl流量。但是这项特性可能会被滥用，使得恶意协议通过http隧道流入某个组织内部。

9.**中继**是没有完全遵循http规范的简单http代理。中继负责处理http中建立连接的部分，然后对字节进行盲转发。但是如果盲中继不支持Connection首部，就会使原始服务器挂起。对大规模部署来说，需要非常认真地考虑使用真正的，完全遵循http的代理服务器，不要使用中继。










