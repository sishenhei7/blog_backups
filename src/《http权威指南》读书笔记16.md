## 概述

最近对http很感兴趣，于是开始看[《http权威指南》](https://book.douban.com/subject/10746113/)。别人都说这本书有点老了，而且内容太多。我个人觉得这本书**写的太好了**，非常长知识，让你知道关于http的很多概念，不仅告诉你怎么做，还告诉你为什么这么做。于是我把学到的知识点记录下来，供以后开发时参考，相信对其他人也有用。

### 内容协商与转码

1.有三种**内容协商技术**：
- 客户端驱动的协商。客户端发起请求，服务器发送可选项的列表，客户端选择。缺点是要发送2次http请求，并且需要多个url，公共页面要一个，其它每种特殊页面也都要一个。
- 服务器驱动的额协商。服务器检查客户端的请求首部集并决定提供哪个版本的页面。缺点是需要客户端发送足够的信息。
- 透明协商。某个中间设备代表客户端进行请求协商。

2.服务器协商的**2种机制**：
- 检查内容协商首部集。服务器查看客户端发送的Accept首部集，设法用响应的响应首部与之匹配。
- 根据其它首部进行变通。例如，服务器可以根据客户端发送的User-Agent首部来发送响应。

3.http的**vary响应首部**中列出了所有客户端请求首部，服务器可用这些首部来选择文档或产生定制的内容。例如：若所提供的文档取决于User-Agent首部，Vary首部就必须包含User-Agent。

4.有三种类型的**转码**：
- 格式转换。将数据从一种格式转换成另一种格式。
- 信息综合。从文档中提取关键的信息片段。
- 内容注入。注入一些内容。比如自动广告生成器和用户追踪系统。

5.内容协商并**不只限于Accept和Content这两个首部集**：
- http中的内容协商收到一些性能方面的限制。
- http不是唯一需要进行内容协商的协议。比如还有流媒体和传真。
